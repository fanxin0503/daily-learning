# 咸鱼日记

##### 【日期】

2020-09-01

##### 【关键字】

> npm、Jenkins、打包速度优化、node_modules

##### 【内容】

今天优化了Jenkins打包速度慢的问题，总结一下：

- package-lock.json很重要，有了它可以不用每次重复构建依赖树，需要跟着项目代码一起提交
- 打包脚本里还有指定安装某个包的操作，差评。应该使用package.json和package-lock.json，充分利用npm的缓存机制
- 在安装某些包之后（尤其Node端），会紧跟着执行脚本用node-gyp进行本地编译，过程中需要访问一些外网地址，又因为打包环境是受限网络，没能连上外网并且也没有合理的反馈，从而导致超时，浪费了时间。最后为npm配置代理就好了，配置方法可以选择全局配置也可以用.npmrc配置文件，配置参数为proxy和https_proxy，格式为 `协议://账号:密码@IP:端口`
- 顺便学习了npm的依赖的依赖树构建规则和缓存机制，并去缓存目录里根据加密规则找了找缓存的包

##### 【参考资料】

[前端工程化 - 剖析npm的包管理机制](https://juejin.im/post/6844904022080667661#heading-40)



------

